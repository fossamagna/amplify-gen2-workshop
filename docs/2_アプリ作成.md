# アプリ作成

Kiro CLI を使って todo アプリを実装していきます。

## setup

### 準備済み フレームワークの確認

本ワークショップで利用する初期設定がすでにセットアップされています。

<details>

```shell
# vite - react のセットアップ
npm create vite@latest todo-app -- --template react-ts

# amplify のセットアップ
npm create amplify@latest -- --template react-vite
```

</details>

以下のことを確認してください

1. todo-app ディレクトリが存在する
2. todo-app/amplify ディレクトリが存在する

### 依存関係のインストール

アプリケーション作成に必要な Javascript ライブラリをインストールしておきます。

```shell
# 新しいターミナルを起動
cd /workspaces/sample/todo-app
npm install
```

### CDK Bootstrap

Amplify Gen2 は裏側で CDK を利用します。

CDK を初めて利用する AWS 環境・リージョンでは CDK Bootstrap という処理が必要です。

[CDK Bootstrap とは](https://docs.aws.amazon.com/ja_jp/cdk/v2/guide/bootstrapping-env.html)

まだやっていない環境であれば、[マネコン](https://us-east-1.console.aws.amazon.com/amplify/create/bootstrap?region=us-east-1)にアクセスして Bootstrap を実行してください。

5 分程度かかりますので、お待ちください。

`CDKToolkit は us-east-1 リージョンですでに正常にセットアップされています。`と表示されていれば、OK です。

### サーバの起動

#### amplify sandbox

amplify sandbox サーバを起動しておきます。

```shell
cd /workspaces/sample/todo-app
npx ampx sandbox
```

Amplify Gen2 を開発するための Sandbox 環境が構築されます。

5 分程度かかりますので、お待ちください。

`File written: amplify_outputs.json`と表示されれば OK です。

#### Vite

また、vite 開発サーバを起動しておきます。

```shell
# 新しいターミナルを起動
cd /workspaces/sample/todo-app
npm run dev

➜  Local:   http://localhost:5173/
```

`ブラウザで開く`をクリックすると、別タブでアプリが表示されます。

別タブで`Vite + React`と記載されたページが表示されれば OK です。

このアプリを改良して Todo アプリにします。

## Kiro CLI によるコーティング支援

Kiro 先生に作ってもらいましょう。

### ログイン画面

では、さっそくアプリを作っていきましょう。
まずはログイン画面です。

```shell
kiro-cli
>
Amplify UIでログイン画面を作成してください。
最初にaws mpcサーバのAmplify ガイド付きワークフローを確認してください。
次に状況を確認して実装に移ってください。現在の状況は以下の通りです。

## プロジェクトセットアップ
* `npm create vite@latest todo-app -- --template react-ts`
* `npm create amplify@latest -- --template react-vite`

## 開発サーバ
* `npm run start` : viteサーバの起動
* `npx ampx sandbox` : amplify sandboxサーバの起動

日本語で回答してください。
```

別タブで表示されているアプリにログイン画面が表示されたら OK です。
SignUp まで済ませておきましょう。

### todo 機能

次に todo 機能を追加してもらいます。

```shell
kiro-cli
>
todo機能を追加してください。

## 必要な機能
必要な機能は以下の通りです。

* ユーザーが自分のtodoをCRUDできる
* ユーザーが他の人のtodoをReadできる
* todoには以下の項目が存在する
    * title: string
    * content: string
    * status: enum[pending, in_progress, completed]
    * category: string[]

## 実装手順
以下の順で実装してください

1. `amplify/`ディレクトリ以下を修正し、バックエンドを実装する
2. `src/`ディレクトリ以下を修正し、フロントエンドを実装する

日本語で回答してください。
```

todo アプリに様変わりしたら OK です。
実際にアプリを使ってみて、動作に問題がないことを確認しましょう。

### デザイン修正

最後にデザインを整えてもらいます。

```shell
kiro-cli
>
todoアプリのデザインを整えてください。
要望としては以下の通りです。

* <自由に変更してください>なテイストにする
* Amplify UIを利用する

日本語で回答してください。
```

最後に成果をコミットしておきましょう。

ここまで確認できたら、次([docs/3_hosting.md](3_hosting.md))に進んでください。
